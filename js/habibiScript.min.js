document.addEventListener("DOMContentLoaded",function(){});var adminCPItems=document.querySelector(".admin-cp-items"),adminCPBtn=document.querySelector(".admin-cp-button");adminCPBtn.addEventListener("click",function(){adminCPItems.classList.toggle("hidden")},!1);var pageSplash=document.querySelector("#pageSplash"),splashScreenTxt=document.querySelector("#splashScreenTxt"),splashScreenLogo=document.querySelector("#splashScreenLogo"),pagePlayDelay=document.querySelector("#pagePlayDelay"),palyDelayCont=document.querySelector("#palyDelayCont"),playDelayNum=document.querySelector("#playDelayNum"),pagePlayArea=document.querySelector("#pagePlayArea"),gmStatsTimeProgress=document.querySelector("#gmStatsTimeProgress"),gmStatsPauseBtn=document.querySelector("#gmStatsPauseBtn"),gmStatsScore=document.querySelector("#gmStatsScore"),gmStatsLvlNumb=document.querySelector("#gmStatsLvlNumb"),gameSpace=document.querySelector("#gameSpace"),gmStatsCurrentTapCount=document.querySelector("#gmStatsCurrentTapCount"),gmStatsTotalTapCount=document.querySelector("#gmStatsTotalTapCount"),pageGameMenu=document.querySelector("#pageGameMenu"),newGameBtn=document.querySelector("#newGameBtn"),highScoresBtn=document.querySelector("#highScoresBtn"),aboutBtn=document.querySelector("#aboutBtn"),pageTutorial=document.querySelector("#pageTutorial"),tutPgStartGameBtn=document.querySelector("#tutPgStartGameBtn"),pagePauseMenu=document.querySelector("#pagePauseMenu"),lvlPausedScore=document.querySelector("#lvlPausedScore"),pmRstrtLvlBtn=document.querySelector("#pmRstrtLvlBtn"),pmCntnuGmBtn=document.querySelector("#pmCntnuGmBtn"),lvlPssdTitle=document.querySelector("#lvlPssdTtl"),lvlPssdScore=document.querySelector("#lvlPssdScore"),lvlPssdBonusScore=document.querySelector("#lvlPssdBonusScore"),lvlPssdContinueNextLvlBtn=document.querySelector("#lvlPssdContinueNextLvlBtn"),pageYouLost=document.querySelector("#pageYouLost"),gameOverScore=document.querySelector("#game-over-score"),lvlLostBestScore=document.querySelector("#lvlLostBestScore"),lvlLostTtl=document.querySelector("#lvlLostTtl"),lvlLostTryAgainBtn=document.querySelector("#lvlLostTryAgainBtn"),lvlLostIcon=document.querySelector("#lvlLostIcon"),pageHighScore=document.querySelector("#pageHighScore"),lvlLostNewHighScore=document.querySelector("#lvlLostNewHighScore"),pageAbout=document.querySelector("#pageAbout"),abtPageBackBtn=document.querySelector("#abtPageBackBtn"),playDelayPageToggle=document.getElementById("playDelayPageToggle"),playAreaPageToggle=document.getElementById("playAreaPageToggle"),gameMenuPageToggle=document.getElementById("gameMenuPageToggle"),tutorialPageToggle=document.getElementById("tutorialPageToggle"),pauseMenuPageToggle=document.getElementById("pauseMenuPageToggle"),youLostPageToggle=document.getElementById("youLostPageToggle"),highScorePageToggle=document.getElementById("highScorePageToggle"),aboutPageToggle=document.getElementById("aboutPageToggle"),splashPageToggle=document.getElementById("splashPageToggle"),pagesTogglesArray=[playAreaPageToggle,gameMenuPageToggle,tutorialPageToggle,playDelayPageToggle,pauseMenuPageToggle,youLostPageToggle,highScorePageToggle,aboutPageToggle,splashPageToggle],pagesArray=[pagePlayArea,pageGameMenu,pageTutorial,pagePlayDelay,pagePauseMenu,pageYouLost,pageHighScore,pageAbout,pageSplash];togglePage=function(e,n){e.checked?toolsBox.showPage(n):toolsBox.hidePage(n)};for(var i=0;i<pagesTogglesArray.length;i++)pagesTogglesArray[i].addEventListener("click",function(){for(var e=0;e<pagesTogglesArray.length;e++)togglePage(pagesTogglesArray[e],pagesArray[e])},!1);toolsBox={generateUUID:function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===n?t:3&t|8).toString(16)})},delay:function(e,n){setTimeout(e,n)},gnrtRndmNum:function(e,n){return Math.floor(Math.random()*(n-e+1))+e},showPage:function(e){e.style.display="block"},hidePage:function(e){e.style.display="none"},hideSplashScreen:function(){splashScreenTxt.classList.add("fadeOut-animation"),splashScreenLogo.classList.add("fadeOut-animation"),toolsBox.delay(function(){toolsBox.showPage(pageGameMenu),toolsBox.hidePage(pageSplash)},1500)},onClickNTouchstart:function(e,n){e.addEventListener("click",n,!1),e.addEventListener("touchstart",n,!1)},toggleAnimation:function(e,n){e.classList.add(n),e.addEventListener("animationend",function(){e.classList.remove(n)},!1)},windowSize:{width:window.innerWidth||document.body.clientWidth,height:window.innerHeight||document.body.clientHeight},pagePlayDelay:{updateNumber:function(){toolsBox.toggleAnimation(playDelayNum,"grow-animation"),playDelayNum.innerHTML=parseInt(playDelayNum.innerHTML,10)-1},start:function(){toolsBox.toggleAnimation(playDelayNum,"grow-animation");var e=setInterval(function(){playDelayNum.innerHTML>1?(audioPool.playSound(delayCount),toolsBox.pagePlayDelay.updateNumber()):(clearInterval(e),toolsBox.hidePage(pagePlayDelay),playDelayNum.innerHTML=3)},500)}}};var circlesEngine={create:function(){var e=document.createElement("div");return e.id=toolsBox.generateUUID(),setTimeout(function(){circlesEngine.remove(e,!0)},gameEngine.circleDespawnTime),e.setAttribute("class","tpbl-circle c-blue good-circle"),gameSpace.appendChild(e),toolsBox.onClickNTouchstart(e,function(){gameEngine.goodCircleTap(),gameEngine.updateCircleDespawnTime(),circlesEngine.remove(e,!1)}),e},remove:function(e,n){null!=e&&null!=e.parentNode&&(e.parentNode.removeChild(e),circlesPosition[defaultGameValues.circle-1].timeDespawn=Date.now(),!0===n&&e.className.includes(gameEngine.circleType.good)&&(gameEngine.resetCircleDespawnTime(),gameEngine.resetBonusScore(),gameEngine.lostLife()),circlesEngine.add())},destroy:function(e){Array.from(e).forEach(function(e){e.parentNode.removeChild(e)})},setPosition:function(e){e.style.left=circlesPosition[defaultGameValues.circle].x,e.style.top=circlesPosition[defaultGameValues.circle].y,circlesPosition[defaultGameValues.circle].timeSpawn=Date.now(),defaultGameValues.circle++},add:function(){gameEngine.currentlyPlaying&&(circle=circlesEngine.create(),circlesEngine.setPosition(circle),circlesEngine.addWithDelay(i,circle))},addWithDelay:function(e,n){setTimeout(function(){n.classList.add("grow-animation"),audioPool.playSound(circleAppear)},50*e)}},circlesPosition=[{x:"555px",y:"138px",timeSpawn:null,timeDespawn:null},{x:"140px",y:"168px",timeSpawn:null,timeDespawn:null},{x:"344px",y:"391px",timeSpawn:null,timeDespawn:null},{x:"441px",y:"98px",timeSpawn:null,timeDespawn:null},{x:"85px",y:"112px",timeSpawn:null,timeDespawn:null},{x:"199px",y:"462px",timeSpawn:null,timeDespawn:null},{x:"490px",y:"400px",timeSpawn:null,timeDespawn:null},{x:"138px",y:"513px",timeSpawn:null,timeDespawn:null},{x:"534px",y:"70px",timeSpawn:null,timeDespawn:null},{x:"212px",y:"453px",timeSpawn:null,timeDespawn:null},{x:"178px",y:"343px",timeSpawn:null,timeDespawn:null},{x:"484px",y:"164px",timeSpawn:null,timeDespawn:null},{x:"104px",y:"170px",timeSpawn:null,timeDespawn:null},{x:"218px",y:"62px",timeSpawn:null,timeDespawn:null},{x:"262px",y:"341px",timeSpawn:null,timeDespawn:null},{x:"90px",y:"527px",timeSpawn:null,timeDespawn:null},{x:"239px",y:"526px",timeSpawn:null,timeDespawn:null},{x:"350px",y:"522px",timeSpawn:null,timeDespawn:null},{x:"62px",y:"318px",timeSpawn:null,timeDespawn:null},{x:"50px",y:"443px",timeSpawn:null,timeDespawn:null},{x:"293px",y:"522px",timeSpawn:null,timeDespawn:null},{x:"69px",y:"349px",timeSpawn:null,timeDespawn:null},{x:"191px",y:"450px",timeSpawn:null,timeDespawn:null},{x:"282px",y:"59px",timeSpawn:null,timeDespawn:null},{x:"123px",y:"523px",timeSpawn:null,timeDespawn:null},{x:"156px",y:"313px",timeSpawn:null,timeDespawn:null},{x:"236px",y:"309px",timeSpawn:null,timeDespawn:null},{x:"333px",y:"129px",timeSpawn:null,timeDespawn:null},{x:"388px",y:"502px",timeSpawn:null,timeDespawn:null},{x:"283px",y:"237px",timeSpawn:null,timeDespawn:null},{x:"200px",y:"449px",timeSpawn:null,timeDespawn:null},{x:"312px",y:"206px",timeSpawn:null,timeDespawn:null},{x:"413px",y:"102px",timeSpawn:null,timeDespawn:null},{x:"536px",y:"500px",timeSpawn:null,timeDespawn:null},{x:"173px",y:"234px",timeSpawn:null,timeDespawn:null},{x:"331px",y:"105px",timeSpawn:null,timeDespawn:null},{x:"479px",y:"394px",timeSpawn:null,timeDespawn:null},{x:"524px",y:"445px",timeSpawn:null,timeDespawn:null},{x:"438px",y:"77px",timeSpawn:null,timeDespawn:null},{x:"305px",y:"107px",timeSpawn:null,timeDespawn:null},{x:"439px",y:"352px",timeSpawn:null,timeDespawn:null},{x:"132px",y:"306px",timeSpawn:null,timeDespawn:null},{x:"540px",y:"421px",timeSpawn:null,timeDespawn:null},{x:"248px",y:"286px",timeSpawn:null,timeDespawn:null},{x:"516px",y:"222px",timeSpawn:null,timeDespawn:null},{x:"499px",y:"437px",timeSpawn:null,timeDespawn:null},{x:"415px",y:"143px",timeSpawn:null,timeDespawn:null},{x:"47px",y:"100px",timeSpawn:null,timeDespawn:null},{x:"541px",y:"349px",timeSpawn:null,timeDespawn:null},{x:"306px",y:"392px",timeSpawn:null,timeDespawn:null},{x:"97px",y:"445px",timeSpawn:null,timeDespawn:null},{x:"307px",y:"494px",timeSpawn:null,timeDespawn:null},{x:"198px",y:"212px",timeSpawn:null,timeDespawn:null},{x:"140px",y:"214px",timeSpawn:null,timeDespawn:null},{x:"476px",y:"482px",timeSpawn:null,timeDespawn:null},{x:"287px",y:"527px",timeSpawn:null,timeDespawn:null},{x:"573px",y:"98px",timeSpawn:null,timeDespawn:null},{x:"166px",y:"522px",timeSpawn:null,timeDespawn:null},{x:"202px",y:"351px",timeSpawn:null,timeDespawn:null},{x:"581px",y:"44px",timeSpawn:null,timeDespawn:null},{x:"420px",y:"472px",timeSpawn:null,timeDespawn:null},{x:"503px",y:"219px",timeSpawn:null,timeDespawn:null},{x:"485px",y:"283px",timeSpawn:null,timeDespawn:null},{x:"517px",y:"192px",timeSpawn:null,timeDespawn:null},{x:"172px",y:"230px",timeSpawn:null,timeDespawn:null},{x:"154px",y:"347px",timeSpawn:null,timeDespawn:null},{x:"303px",y:"254px",timeSpawn:null,timeDespawn:null},{x:"455px",y:"336px",timeSpawn:null,timeDespawn:null},{x:"274px",y:"334px",timeSpawn:null,timeDespawn:null},{x:"546px",y:"455px",timeSpawn:null,timeDespawn:null},{x:"52px",y:"99px",timeSpawn:null,timeDespawn:null},{x:"64px",y:"348px",timeSpawn:null,timeDespawn:null},{x:"50px",y:"388px",timeSpawn:null,timeDespawn:null},{x:"429px",y:"348px",timeSpawn:null,timeDespawn:null},{x:"460px",y:"496px",timeSpawn:null,timeDespawn:null},{x:"212px",y:"120px",timeSpawn:null,timeDespawn:null},{x:"309px",y:"479px",timeSpawn:null,timeDespawn:null},{x:"507px",y:"350px",timeSpawn:null,timeDespawn:null},{x:"469px",y:"517px",timeSpawn:null,timeDespawn:null},{x:"99px",y:"352px",timeSpawn:null,timeDespawn:null},{x:"100px",y:"453px",timeSpawn:null,timeDespawn:null},{x:"107px",y:"108px",timeSpawn:null,timeDespawn:null},{x:"173px",y:"359px",timeSpawn:null,timeDespawn:null},{x:"450px",y:"273px",timeSpawn:null,timeDespawn:null},{x:"590px",y:"251px",timeSpawn:null,timeDespawn:null},{x:"98px",y:"466px",timeSpawn:null,timeDespawn:null},{x:"284px",y:"116px",timeSpawn:null,timeDespawn:null},{x:"580px",y:"101px",timeSpawn:null,timeDespawn:null},{x:"446px",y:"402px",timeSpawn:null,timeDespawn:null},{x:"419px",y:"276px",timeSpawn:null,timeDespawn:null},{x:"420px",y:"496px",timeSpawn:null,timeDespawn:null},{x:"570px",y:"273px",timeSpawn:null,timeDespawn:null},{x:"77px",y:"85px",timeSpawn:null,timeDespawn:null},{x:"533px",y:"452px",timeSpawn:null,timeDespawn:null},{x:"54px",y:"480px",timeSpawn:null,timeDespawn:null},{x:"551px",y:"453px",timeSpawn:null,timeDespawn:null},{x:"109px",y:"402px",timeSpawn:null,timeDespawn:null},{x:"374px",y:"162px",timeSpawn:null,timeDespawn:null}],defaultGameValues={score:0,life:3,circle:0,circleDespawnTime:2e3},gameEngine={circleDespawnTime:2e3,currentlyPlaying:!1,life:3,currentStreak:0,streakBreaker:[0,0,0,0],circleType:{good:"good-circle",evil:"evil-circle"},chanceToHaveGoodCircle:.25,timePenalty:8,score:0,goodCirclesCount:2,evilCirclesCount:5,highestScore:0,bonusScore:0,spawnCircle:function(){var e=".evil-circle";return Math.random()<=gameEngine.chanceToHaveGoodCircle&&(e=".good-circle"),e},updateScore:function(e){e<0?(document.getElementById("gmStatsScore").innerHTML="0",gameEngine.lostLife()):(gameEngine.score=e,gmStatsScore.innerHTML=gameEngine.score)},lostLife:function(){gameEngine.life<=0&&gameEngine.gameOver(),gameEngine.currentStreak++,gameEngine.life--,document.getElementById("gmStatsCurrentLife").innerHTML=gameEngine.life},updateCircleDespawnTime(){gameEngine.circleDespawnTime=defaultGameValues.circleDespawnTime-100*gameEngine.bonusScore},resetCircleDespawnTime(){gameEngine.circleDespawnTime=defaultGameValues.circleDespawnTime},updateBonusScore:function(){gameEngine.bonusScore++,document.getElementById("gmStatsBonus").innerHTML=gameEngine.bonusScore},resetBonusScore:function(){gameEngine.bonusScore=0,document.getElementById("gmStatsBonus").innerHTML=gameEngine.bonusScore},resetSendScoreToBlockchainbutton:function(){$("#sbmt-score").removeAttr("disabled"),$("#sbmt-score").addClass("btn-blue")},resetCirclesPositionArray:function(){circlesPosition.forEach(e=>{e.timeSpawn=null,e.timeDespawn=null})},resetLife:function(){document.getElementById("gmStatsCurrentLife").innerHTML="3",gameEngine.life=defaultGameValues.life},resetStreak:function(){gameEngine.currentStreak=0,gameEngine.streakBreaker=[0,0,0,0]},reset:function(){gameEngine.resetSendScoreToBlockchainbutton(),gameEngine.resetCirclesPositionArray(),gameEngine.updateScore(defaultGameValues.score),gameEngine.resetLife(),gameEngine.resetStreak(),defaultGameValues.circle=0,gameEngine.goodCirclesCount=defaultGameValues.goodCirclesCount,gameEngine.evilCirclesCount=defaultGameValues.evilCirclesCount},start:function(){gameEngine.currentlyPlaying=!0,gameEngine.updateScore(gameEngine.score),gameEngine.goodCirclesCount=gameEngine.goodCirclesCount,gameEngine.evilCirclesCount=gameEngine.evilCirclesCount,console.log("Game Started! ðŸ"),circlesEngine.add()},goodCircleTap:function(){var e=0===gameEngine.bonusScore?10:10*gameEngine.bonusScore;gameEngine.streakBreaker[gameEngine.currentStreak]++,gameEngine.updateBonusScore(),gameEngine.updateScore(gameEngine.score+e)},evilCircleTap:function(){gameEngine.resetBonusScore(),gameEngine.updateScore(gameEngine.score-10),gameEngine.lostLife()},stop:function(){gameEngine.currentlyPlaying=!1,console.log("game STOPPED!")},gameLost:function(){audioPool.playSound(levelLost),gameOverScore.innerHTML=gameEngine.score,toolsBox.hidePage(pagePlayArea),toolsBox.showPage(pageYouLost),gameEngine.stop()},gameOver:function(){gameEngine.currentlyPlaying=!1,console.log("You lost! ðŸœ"),lvlLostTtl.innerHTML="You Lost",lvlLostIcon.classList.contains("times-up-icon")&&(lvlLostIcon.classList.remove("times-up-icon"),lvlLostIcon.classList.add("you-lost-icon")),gameEngine.gameLost()},showBonusScore:function(){console.log("You got "+10*Math.round(timeEngine.timeLeft)+" extra score because you finished "+timeEngine.timeLeft+" seconds before the time!"),gameEngine.updateBonusScore(10*Math.round(timeEngine.timeLeft,10)),gameEngine.bonusScore>0&&(lvlPssdBonusScore.innerHTML="Bonus +"+gameEngine.bonusScore),gameEngine.score+=gameEngine.bonusScore}},audioPool={sounds:[circleAppear={sound:"circleAppear",preaload:!0,volume:1,loop:!1},touchBlue={sound:"touchBlue",preaload:!0,volume:.5,loop:!1},touchRed={sound:"touchRed",preaload:!0,volume:1,loop:!1},levelPassed={sound:"levelPassed",preload:!0,volume:1,loop:!1},levelLost={sound:"levelLost",preload:!0,volume:1,loop:!1},buttonTap={sound:"buttonTap",preload:!0,volume:1,loop:!1},delayCount={sound:"delayCount",preload:!0,volume:1,loop:!1},timeAlmostUp={sound:"timeAlmostUp",preload:!0,volume:.5,loop:!0}],createAudioPlayer:function(e){e.audioPlayer=document.createElement("audio"),mp3Source=document.createElement("source"),oggSource=document.createElement("source"),mp3Link="sounds/mp3/"+e.sound+".mp3",oggLink="sounds/ogg/"+e.sound+".ogg",mp3Source.setAttribute("type","audio/mpeg"),oggSource.setAttribute("type","audio/ogg"),mp3Source.setAttribute("src",mp3Link),oggSource.setAttribute("src",oggLink),e.audioPlayer.appendChild(mp3Source),e.audioPlayer.appendChild(oggSource),document.body.appendChild(e.audioPlayer),e.audioPlayer.volume=e.volume,e.preload&&e.audioPlayer.load(),e.loop&&(e.audioPlayer.loop=!0)},addSounds:function(){for(var e=0;e<audioPool.sounds.length;e++)audioPool.createAudioPlayer(audioPool.sounds[e])},playSound:function(e){e.audioPlayer.currentTime=0,e.audioPlayer.play()},stopSound:function(e){e.audioPlayer.pause(),e.audioPlayer.currentTime=0}};audioPool.addSounds(),document.ontouchmove=function(e){e.preventDefault()},toolsBox.onClickNTouchstart(tutPgStartGameBtn,function(){audioPool.playSound(buttonTap),gameEngine.stop(),toolsBox.hidePage(pageTutorial),toolsBox.showPage(pagePlayDelay),toolsBox.pagePlayDelay.start(),toolsBox.delay(function(){toolsBox.showPage(pagePlayArea)},1e3),toolsBox.delay(gameEngine.start,1500)}),lvlLostTryAgainBtn.addEventListener("click",function(){audioPool.playSound(buttonTap),toolsBox.hidePage(pageYouLost),toolsBox.showPage(pageGameMenu),gameEngine.stop()},!1),toolsBox.onClickNTouchstart(pmRstrtLvlBtn,function(){audioPool.playSound(buttonTap),toolsBox.showPage(pageGameMenu),toolsBox.hidePage(pagePauseMenu),gameEngine.stop()}),toolsBox.onClickNTouchstart(pmCntnuGmBtn,function(){audioPool.playSound(buttonTap),toolsBox.showPage(pagePlayArea),toolsBox.hidePage(pagePauseMenu),gameEngine.resume()}),abtPageBackBtn.addEventListener("click",function(){audioPool.playSound(buttonTap),toolsBox.showPage(pageGameMenu),toolsBox.hidePage(pageAbout),toolsBox.pageAbout.stopMovingCredits()},!1),newGameBtn.addEventListener("click",function(){audioPool.playSound(buttonTap),toolsBox.showPage(pageTutorial),toolsBox.hidePage(pageGameMenu)},!1),aboutBtn.addEventListener("click",function(){audioPool.playSound(buttonTap),toolsBox.showPage(pageAbout),toolsBox.hidePage(pageGameMenu)},!1),toolsBox.hideSplashScreen();const BackendUrl="https://global-214922.appspot.com",NotFoundError=404;let ApprovingPlayer=[];async function sendScoreToMantleBlockchain(e,n,t){var a={ownedDisplayName:e,amount:n,metaData:t.toString(),streakBreaker:gameEngine.streakBreaker};console.log(a);var l={headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)};return await fetch(`${BackendUrl}/scores`,l)}function disableButton(e){$(e).attr("disabled",!0),$(e).removeClass("btn-blue")}async function sendScoreToBlockchain(){if(ApprovingPlayer.length>0){console.log("trying to send score...");var e=ApprovingPlayer.pop();await sendScoreToMantleBlockchain(e.name,e.score,e.metaData).then(n=>{n.ok||ApprovingPlayer.push(e)})}}function showPopup(){$(".popupInfo").fadeIn("slow"),setTimeout(()=>{$(".popupInfo").fadeOut("slow")},2e3)}async function Get50BestResults(){$("highscoreList").empty(),await fetch(`${BackendUrl}/scores`,{headers:{"Content-Type":"application/json"},method:"GET"}).then(e=>{e.ok&&e.json().then(e=>{e.batches.forEach(function(e){var n=new Date(e.timestamp);$("#highscoreList").append(`<li id=${e.id} class='highscoreitem ${e.blockchainStatus}'><p class="firstitem">${n.toLocaleString()}<p class="seconditem">${e.recipientDisplayName}<p class="thirditem">${e.amount}</p></p></p</li>`)})})})}async function ValidateScore(){var e=$("#scoreName").val(),n=new Date($("#scoreDate").val()),t=$("#scoreAmount").val();await fetch(`${BackendUrl}/scores`,{headers:{"Content-Type":"application/json"},method:"GET"}).then(a=>{a.ok&&a.json().then(a=>{var l="";a.batches.forEach(function(a){if(""==l&&"Confirmed"==a.blockchainStatus&&t==a.amount){var o=new Date(a.timestamp);o.setHours(0,0,0),""+n==""+o&&e.toLowerCase()==a.recipientDisplayName.toLowerCase()&&(l=a.batchId)}}),""==l&&(l=makeid(getRandomArbitrary(36,42))),$("#scoreSignatureLink").attr("href","https://wavesexplorer.com/testnet/tx/"+l),$("#scoreSignatureLink").html(l)})})}function makeid(e){for(var n="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=t.length,l=0;l<e;l++)n+=t.charAt(Math.floor(Math.random()*a));return n}function getRandomArbitrary(e,n){return Math.random()*(n-e)+e}$("#sbmt-score").click(async function(){showPopup(),disableButton(this);for(var e=""===$("#name").val().trim()?"Undefined-appleby":$("#name").val(),n=[],t=0;t<=defaultGameValues.circle;t++)null!=circlesPosition[t].timeDespawn&&null!=circlesPosition[t].timeSpawn&&(n[t]=circlesPosition[t].timeDespawn-circlesPosition[t].timeSpawn);await sendScoreToMantleBlockchain(e,gameEngine.score,n).then(t=>{if(!t.ok&&404==t.status){ApprovingPlayer.push({name:e,score:gameEngine.score,metaData:n});var a={ownedIdentifier:e},l={headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)};fetch(`${BackendUrl}/players`,l)}})}),$("#lvlLostTryAgainBtn").click(function(){gameEngine.reset()}),$("#highScoresBtn").click(async function(){$("#highscoreList").empty(),$("#pageGameMenu").hide(),$("#pageHighscore").show(),await Get50BestResults()}),$("#scoreValidator").click(async function(){$("#pageGameMenu").hide(),$("#pageScoreValidator").show()}),$("#backtohighscore").click(function(){$("#pageHighscoreAudit").hide(),$("#pageHighscore").show(),$("#circleClicked").empty()}),$("#backtomenu").click(function(){$("#pageHighscore").hide(),$("#highscoreList").empty(),$("#pageGameMenu").show()}),$(".backArrow").click(function(){$("#pageScoreValidator").hide(),$("#pageGameMenu").show()}),$("#scoreSignatureBtn").click(function(){ValidateScore()}),$(document).on("click",".highscoreitem",async function(){$("#circleClicked").empty(),$("#pageHighscore").hide(),$("#pageHighscoreAudit").show();var e=$(this).attr("id");await fetch(`${BackendUrl}/scores/${e}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then(n=>{n.ok?n.json().then(n=>{var t;if(n.transactions.forEach(function(n,a){n.batchId==e&&"Confirmed"==n.blockchainStatus&&(t=n)}),null!=t){var a=t.metaData.split(","),l=t.amount,o=0,i=0,u=99999999;a.forEach(function(e,n){var t=parseFloat(e)/1e3;t<2e3&&(o++,i+=t),t<u&&(u=t),0,$("#circleClicked").append(`<li><p class="firstitem">circle${n} <p class="thirditem">${t} sec</p></p</li>`)}),$("#points").text(l),$("#total").text(o),$("#fastest").text(u+" SEC"),$("#average").text(parseFloat(i/o).toFixed(3)+" SEC")}}):console.log("Your HighScore is not yet confirm in blockchain.")})}),$(function(){$("#highscoreList").contextMenu({selector:"li",callback:function(e,n){$("#scoreDate").val($(this).children(".firstitem").text().split(",")[0]),$("#scoreName").val($(this).children(".seconditem").text()),$("#scoreAmount").val($(this).children(".thirditem").text()),$("#pageHighscore").hide(),$("#highscoreList").empty(),$("#pageScoreValidator").show()},items:{edit:{name:"Validate",icon:"fas fa-share-square"}}})}),$(document).ready(async function(){setInterval(await sendScoreToBlockchain,15e3),await Get50BestResults()});